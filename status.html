<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Status Pengaduan</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="" name="keywords"/>
  <meta content="" name="description"/>

  <!-- Favicon -->
  <link href="img/favicon.ico" rel="icon"/>

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600&family=Nunito:wght@600;700;800&display=swap" rel="stylesheet"/>

  <!-- Icon Font Stylesheet -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet"/>

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/bootstrap.min.css" rel="stylesheet"/>

  <!-- Stylesheet -->
  <link href="css/style.css" rel="stylesheet"/>
</head>

<body>
  <!-- Spinner Start -->
  <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>
  <!-- Spinner End -->

  <!-- Navbar & Hero Start -->
  <div class="container-fluid position-relative p-0">
    <nav class="navbar navbar-expand-lg navbar-light px-4 px-lg-5 py-3 py-lg-0">
      <a href="" class="navbar-brand p-0">
        <img src="img/Logo.png" alt="Logo 1" class="logo">
        <img src="img/Logo_Yogya.png" alt="Logo 2" class="logo">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
        <span class="fa fa-bars"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <div class="navbar-nav ms-auto py-0">
          <a href="index.html" class="nav-item nav-link">BERANDA</a>
          <a href="trending.html" class="nav-item nav-link">TRENDING</a>
          <div class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">LAYANAN</a>
            <div class="dropdown-menu m-0">
              <a href="ajukan.html" class="dropdown-item">Ajukan Pengaduan</a>
              <a href="status.html" class="dropdown-item">Status Pengaduan</a>
              <a href="faq.html" class="dropdown-item">FAQ</a>
            </div>
          </div>
          <a href="tentang.html" class="nav-item nav-link">TENTANG KAMI</a>
          <a href="login.html" class="nav-item nav-link">MASUK</a>
        </div>
      </div>
    </nav>

    <div class="container-fluid bg-primary py-5 mb-5 hero-header" style="height: 60vh;">
      <div class="container py-5">
        <div class="row justify-content-center py-5">
          <div class="col-lg-10 pt-lg-5 mt-lg-5 text-center">
            <h1 class="display-3 text-dark mb-3">STATUS PENGADUAN</h1>
            <p class="fs-4 text-dark mb-4">Ikuti perkembangan proses pengaduanmu di sini!</p>
            <div class="position-relative w-75 mx-auto">
              <input class="form-control border-0 rounded-pill w-100 py-3 ps-4 pe-5" type="text" placeholder="Masukkan ID Pengaduan Anda"/>
              <button type="button" class="btn rounded-pill py-2 px-4 position-absolute top-0 end-0 me-2" style="margin-top: 7px">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container mt-5">
    <div class="col-lg-8">
      <div class="pengaduan-id mt-4">
        <p><strong>No ID: <span id="pengaduanId"></span></strong></p>
      </div>
      <div class="status-steps mb-5">
        <div class="step active">
          <i class="fas fa-check-circle"></i>
          <p>Dikirim</p>
        </div>
        <div class="step">
          <i class="fas fa-circle"></i>
          <p>Diterima</p>
        </div>
        <div class="step">
          <i class="fas fa-circle"></i>
          <p>Proses Penyelidikan</p>
        </div>
        <div class="step">
          <i class="fas fa-circle"></i>
          <p>Ditindaklanjuti</p>
        </div>
        <div class="step">
          <i class="fas fa-circle"></i>
          <p>Ditutup</p>
        </div>
      </div>
      <div class="laporan">
        <div class="laporan-status">
          <h2 id="laporanStatus">Laporan Pengaduan Anda Sedang Diproses</h2>
          <p id="laporanDeskripsi">Terima kasih atas aduan Anda. Saat ini, laporan pengaduan Anda masih dalam proses. Kami ingin mengingatkan Anda bahwa bukti yang Anda lampirkan sangat penting dalam proses ini. Kami tidak bertanggung jawab atas keterlambatan berkas yang Anda kirimkan.</p>
          <p>Sementara menunggu proses laporan selesai, Anda dapat membantu kami mempercepatnya dengan memberikan data yang lebih mendetail jika diperlukan.</p>
        </div>
        <div class="laporan-detail">
          <h2>Detail Laporan yang Dikirim</h2>
          <ul id="laporanDetail">
            <!-- Details will be inserted here -->
          </ul>
        </div>
        <div class="action-buttons">
          <button type="button" class="btn btn-danger">BATALKAN PENGADUAN</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer Start -->
  <div class="container-fluid bg-dark text-light mt-5 py-5">
    <div class="container">
      <div class="row g-5">
        <div class="col-md-6">
          <h4 class="text-light mb-4">YOGYASAMBAT</h4>
          <p style="color: #ffffff;">Lorem ipsum dolor sit amet consectetur. Egestas amet integer nunc magna nullam mauris pulvinar et.</p>
        </div>
        <div class="col-md-6">
          <h4 class="text-light mb-4">Hubungi Kami</h4>
          <p style="color: #ffffff;"><i class="fa fa-map-marker-alt me-3"></i>Yogyakarta, Indonesia</p>
          <p style="color: #ffffff;"><i class="fa fa-envelope me-3"></i>yogyasambat@gmail.com</p>
          <div class="d-flex pt-2">
            <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-instagram"></i></a>
            <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-twitter"></i></a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Footer End -->

  <!-- Back to Top -->
  <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="fas fa-arrow-up"></i></a>

  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/wow/wow.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const pengaduanId = urlParams.get('id');
      if (pengaduanId) {
        document.getElementById('pengaduanId').textContent = pengaduanId;
        fetchPengaduanDetails(pengaduanId);
      }
    });

    async function fetchPengaduanDetails(id) {
      try {
        const response = await fetch(`http://localhost:3000/pengaduan/${id}`);
        const result = await response.json();

        if (response.ok) {
          const laporanDetail = document.getElementById('laporanDetail');
          laporanDetail.innerHTML = `
            <li>Judul Laporan: ${result.judul}</li>
            <li>Nama Pelapor: ${result.nama}</li>
            <li>Jenis Laporan: ${result.jenis}</li>
            <li>Tanggal Kejadian: ${result.tanggal}</li>
            <li>Lokasi Kejadian: ${result.lokasi}</li>
            <li>Deskripsi Kejadian: ${result.deskripsi}</li>
            <li>Informasi Terlapor: ${result.informasiTerlapor}</li>
          `;
          updateStatusSteps(result.status);
        } else {
          console.error(`Error: ${result.error}`);
        }
      } catch (error) {
        console.error('Error:', error);
      }
    }

    function updateStatusSteps(status) {
      const steps = document.querySelectorAll('.status-steps .step');
      steps.forEach((step, index) => {
        if (index <= status) {
          step.classList.add('active');
          step.querySelector('i').classList.remove('fa-circle');
          step.querySelector('i').classList.add('fa-check-circle');
        }
      });
    }
  </script>
</body>
</html>
